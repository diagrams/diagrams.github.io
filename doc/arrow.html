<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Diagrams - Arrows tutorial</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <!-- Bootstrap -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/sticky-footer-navbar.css" rel="stylesheet" />
    <link href="../css/callout.css" rel="stylesheet" />
    <link href="../css/doc.css" rel="stylesheet" />
    <link href="../css/bootstrap-docs.css" rel="stylesheet" />
    <link href="../css/home.css" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    <link rel="shortcut icon" href="../diagrams.ico" />

    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
  </head>
  <body>

    <div id="wrap">

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../">diagrams</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav pull-right">
            <li><a href="../">Home</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
              <ul class="dropdown-menu">
		<li><a href="../download.html">Installation</a></li>
		<li class="divider"></li>
 		<li><a href="../tutorials.html">Tutorials</a></li>
		<li><a href="../doc/manual.html">User manual</a></li>
                <li><a href="../haddock/index.html">API reference (Haddocks)</a></li>
                <li><a href="../doc/core.html">Core library reference</a></li>
		<li class="divider"></li>
		<li><a href="http://haskell.org/haskellwiki/Diagrams">Wiki</a></li>
		<li><a href="../releases.html">Releases / changelogs</a></li>
              </ul>
            </li>
	    <li><a href="../gallery.html">Gallery</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
	      <ul class="dropdown-menu">
		<li><a href="http://webchat.freenode.net?channels=diagrams">IRC channel</a></li>
		<li><a href="http://groups.google.com/group/diagrams-discuss">Mailing
		    list</a></li>
                <li><a href="https://github.com/diagrams">Github</a></li>
		<li><a href="../sightings.html">Sightings</a></li>
		<li><a href="../community.html">Get involved</a></li>
              </ul>
	    </li>
            <li><a href="../blog/index.html">Blog</a></li>
	    <li>
	        <form id="search" class="navbar-form navbar-left" role="search" method="get" action="http://haskell.org/hoogle">
	            <div class="form-group">
	                <input id="hoogle" name="hoogle" type="text" class="form-control" placeholder="API Search">
	            </div>
	        </form>
	    </li>
	   </ul>
        </div>
      </div>
    </div>
    
    <div class="container" style="padding-top: 60px;">
      <?xml version="1.0" encoding="UTF-8" ?>
<div class="container bs-docs-container"><div class="row"><div class="col-md-3"><div class="bs-sidebar hidden-print" role="complementary" data-spy="affix"><ul class="nav"><li><a class="reference internal" href="#introduction">Introduction</a><ul class="nav"><li><a class="reference internal" href="#optional-and-named-parameters">Optional and named parameters</a></li><li><a class="reference internal" href="#scale-invariance">Scale invariance</a></li></ul></li><li><a class="reference internal" href="#connecting-points">Connecting Points</a></li><li><a class="reference internal" href="#arrowopts">ArrowOpts</a><ul class="nav"><li><a class="reference internal" href="#the-head-and-tail-shape">The head and tail shape</a></li><li><a class="reference internal" href="#the-shaft">The shaft</a></li><li><a class="reference internal" href="#lengths-and-gaps">Lengths and Gaps</a></li><li><a class="reference internal" href="#the-style-options">The style options</a></li></ul></li><li><a class="reference internal" href="#placing-an-arrow-at-a-point">Placing an arrow at a point</a></li><li><a class="reference internal" href="#connecting-diagrams-with-arrows">Connecting diagrams with arrows</a></li><li><a class="reference internal" href="#connecting-points-on-the-trace-of-diagrams">Connecting points on the trace of diagrams</a></li></ul></div></div><div class="col-md-9"><div class="section" id="introduction"><h1>Introduction</h1><p>Arrows come in many shapes and sizes and <code>diagrams</code> provides a wide
variety of flexible and extensible tools for creating and using
arrows. The diagram below gives a small taste of some of the different
arrows that can be created easily with <code>diagrams</code>. The
<code>Diagrams.TwoD.Arrow</code> module, along with
<code>Diagrams.TwD.Arrowheads</code>, provides a collection of functions and
options used to make arrows.</p><div class="exampleimg"><div style="text-align: center"><img src="images/205909d09c9cf9af.png" width="500" height="200" /></div></div><div class="section" id="optional-and-named-parameters"><h2>Optional and named parameters</h2><p>Most of the arrow functions take a record argument of optional
parameters (see <a class="reference external" href="http://projects.haskell.org/diagrams/doc/manual.html#faking-optional-named-arguments">Faking optional named parameters</a>) of type
<code class="sourceCode"><span class="dt">ArrowOpts</span></code>. These functions typically have a companion function that
does not take an options record, and uses a default set of
<code class="sourceCode"><span class="dt">ArrowOpts</span></code>. For example, <code class="sourceCode">arrow'</code> takes an options record parameter,
and <code class="sourceCode">arrow</code> does not. In this tutorial, whenever we mention a function
with a single quote (<code class="sourceCode"><span class="ch">'</span></code>) at the end, note there is also a companion
function without the quote that uses a default set of options.</p></div><div class="section" id="scale-invariance"><h2>Scale invariance</h2><p>Arrowheads and -tails are the canonical example of <em>scale invariant</em>
objects: they are not affected by scaling (though they are affected by
other transformations such as rotation and translation). The
<a class="reference external" href="http://projects.haskell.org/diagrams/doc/manual.html#scale-invariance">scale-invariance section of the user manual</a> has a good example
showing why scale-invariance is necessary for the creation of
arrowheads; detailed documentation explaining scale invariant objects
is in <code>Diagrams.TwoD.Transform.ScaleInv</code>.  It turns out that this
module is no longer used internally for the creation of arrowheads, the
technical details of how arrows are actually created is beyond the scope
of this tutorial. The most important
consequence for day-to-day diagramming with arrows is that only the length of
arrowheads and -tails contribute to the envelope of an arrow (the width does not). This is analogous
to the way line width does not contribute to the envelope of a line.</p><div class="warning bs-callout bs-callout-warning"><p>Only the length of arrowheads and tails contribute to the envelope of an arrow!</p></div></div></div><div class="section" id="connecting-points"><h1>Connecting Points</h1><div class="warning bs-callout bs-callout-warning"><p>The default length of an arrow head is <code class="sourceCode">normalized <span class="fl">0.035</span></code> which
scales with the size of the diagram. Since the diagrams in this
tutorial are relatively small and we want to highlight the arrows,
we often set the head length and tail length to a larger size.
This is accomplished using the options <code class="sourceCode">headLength</code> and
<code class="sourceCode">tailLength</code> and the <code class="sourceCode">lengths</code> traversal which will be explained
in the <code class="sourceCode"><span class="dt">Lengths</span> and <span class="dt">Gaps</span></code> section.</p></div><p>A typical use case for an arrow is to connect two points, having an
arrow pointing from one to the other. The function <code class="sourceCode">arrowBetween</code> (and
its cousin <code class="sourceCode">arrowBetween'</code>) connects two points.</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/28a35d36f3bc242a.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> sPt <span class="fu">=</span> p2 (<span class="fl">0.20</span>, <span class="fl">0.20</span>)
<span class="ot">></span> ePt <span class="fu">=</span> p2 (<span class="fl">2.85</span>, <span class="fl">0.85</span>)
<span class="ot">></span>
<span class="ot">></span> <span class="co">-- We use small blue and red circles to mark the start and end points.</span>
<span class="ot">></span> spot <span class="fu">=</span> circle <span class="fl">0.02</span> <span class="fu">#</span> lw none
<span class="ot">></span> sDot <span class="fu">=</span> spot <span class="fu">#</span> fc blue <span class="fu">#</span> moveTo sPt
<span class="ot">></span> eDot <span class="fu">=</span> spot <span class="fu">#</span> fc red  <span class="fu">#</span> moveTo ePt
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span> ( sDot <span class="fu"><></span> eDot <span class="fu"><></span> arrowBetween' (with <span class="fu">&</span> headLength <span class="fu">.~</span> veryLarge) sPt ePt)
<span class="ot">></span>           <span class="fu">#</span> centerXY <span class="fu">#</span> pad <span class="fl">1.1</span></code></pre></div></div></div><div class="exercises panel panel-success"><div class="panel-body"><p>1. Create a diagram which contains a circle of radius 1 with an arrow connecting
the points on the circumference at 45 degrees and 180 degrees.</p></div></div></div><div class="section" id="arrowopts"><h1>ArrowOpts</h1><p>All of the arrow creation functions have a primed variant (<em>e.g.</em>
<code class="sourceCode">arrowBetween</code> and <code class="sourceCode">arrowBetween'</code>) which takes an additional <code class="sourceCode">opts</code>
parameter of type <code class="sourceCode"><span class="dt">ArrowOpts</span></code>. The <code class="sourceCode">opts</code> record is the primary means
of customizing the look of the arrow. It contains a substantial
collection of options to control all of the aspects of an arrow. Here
is the definition for reference:</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> <span class="kw">data</span> <span class="dt">ArrowOpts</span> n <span class="fu">=</span> <span class="dt">ArrowOpts</span>
<span class="ot">></span>   {<span class="ot"> _arrowHead  ::</span> <span class="dt">ArrowHT</span> n
<span class="ot">></span>   ,<span class="ot"> _arrowTail  ::</span> <span class="dt">ArrowHT</span> n
<span class="ot">></span>   ,<span class="ot"> _arrowShaft ::</span> <span class="dt">Trail</span> <span class="dt">V2</span> n
<span class="ot">></span>   ,<span class="ot"> _headGap    ::</span> <span class="dt">Measure</span> n
<span class="ot">></span>   ,<span class="ot"> _tailGap    ::</span> <span class="dt">Measure</span> n
<span class="ot">></span>   ,<span class="ot"> _headStyle  ::</span> <span class="dt">Style</span> <span class="dt">V2</span> n
<span class="ot">></span>   ,<span class="ot"> _headLength ::</span> <span class="dt">Measure</span> n
<span class="ot">></span>   ,<span class="ot"> _tailStyle  ::</span> <span class="dt">Style</span> <span class="dt">V2</span> n
<span class="ot">></span>   ,<span class="ot"> _tailLength ::</span> <span class="dt">Measure</span> <span class="dt">V2</span> n
<span class="ot">></span>   ,<span class="ot"> _shaftStyle ::</span> <span class="dt">Style</span> <span class="dt">V2</span> n
<span class="ot">></span>   }</code></pre></div></div><p>Don't worry if some of the field types in this record are not yet
clear, we will walk through each field and occasionally point to the
API reference for material that we don't cover in this tutorial.</p><div class="section" id="the-head-and-tail-shape"><h2>The head and tail shape</h2><p>The <code class="sourceCode">arrowHead</code> and <code class="sourceCode">arrowTail</code> fields contain information needed to
construct the head and tail of the arrow, the most important aspect
being the shape. So, for example, if we set <code class="sourceCode">arrowHead</code> to <code class="sourceCode">spike</code> and
<code class="sourceCode">arrowTail</code> to <code class="sourceCode">quill</code>,</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> arrowBetween' (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> spike
<span class="ot">></span>                     <span class="fu">&</span> arrowTail <span class="fu">.~</span> quill
<span class="ot">></span>                     <span class="fu">&</span> lengths   <span class="fu">.~</span> veryLarge)
<span class="ot">></span>   sPt ePt</code></pre></div></div><p>then the arrow from the previous example looks like this:</p><div class="exampleimg"><div style="text-align: center"><img src="images/cd6a5daec0051854.png" width="500" height="200" /></div></div><p>The <code class="sourceCode"><span class="dt">Arrowheads</span></code> module exports a number of standard arrowheads
including <code class="sourceCode">tri</code>, <code class="sourceCode">dart</code>, <code class="sourceCode">spike</code>, <code class="sourceCode">thorn</code>, <code class="sourceCode">dart</code>, <code class="sourceCode">lineHead</code>, and <code class="sourceCode">noHead</code>,
with <code class="sourceCode">dart</code> being
the default. Also available are companion functions like <code class="sourceCode">arrowheadDart</code>
that allow finer control over the shape of a dart style head. For tails,
in addition to <code class="sourceCode">quill</code> are <code class="sourceCode">block</code>, <code class="sourceCode">lineTail</code>, and <code class="sourceCode">noTail</code>. Again for more control
are functions like, <code class="sourceCode">arrowtailQuill</code>. Finally, any of the standard arrowheads
can be used as tails by appending a single quote, so for example:</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> arrowBetween' (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> thorn <span class="fu">&</span> arrowTail <span class="fu">.~</span> thorn'
<span class="ot">></span>                     <span class="fu">&</span> lengths  <span class="fu">.~</span> veryLarge) sPt ePt</code></pre></div></div><p>yields:</p><div class="exampleimg"><div style="text-align: center"><img src="images/f0d8ca25684344a9.png" width="500" height="200" /></div></div></div><div class="section" id="the-shaft"><h2>The shaft</h2><p>The shaft of an arrow can be any arbitrary <code class="sourceCode"><span class="dt">Trail</span> <span class="dt">V2</span> n</code> in addition to a
simple straight line. For example, an arc makes a perfectly good
shaft. The length of the trail is irrelevant, as the arrow is scaled
to connect the starting point and ending point regardless of the
length of the shaft.  Modifying our example with the following code
will make the arrow shaft into an arc:</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> shaft <span class="fu">=</span> arc xDir (<span class="dv">1</span><span class="fu">/</span><span class="dv">2</span> <span class="fu">@@</span> turn)
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span> ( sDot <span class="fu"><></span> eDot
<span class="ot">></span>          <span class="fu"><></span> arrowBetween' (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> spike <span class="fu">&</span> arrowTail <span class="fu">.~</span> spike'
<span class="ot">></span>                                 <span class="fu">&</span> arrowShaft <span class="fu">.~</span> shaft
<span class="ot">></span>                                 <span class="fu">&</span> lengths <span class="fu">.~</span> veryLarge) sPt ePt
<span class="ot">></span>           <span class="fu">#</span> frame <span class="fl">0.25</span></code></pre></div></div><div class="exampleimg"><div style="text-align: center"><img src="images/4851e015fe209b81.png" width="500" height="200" /></div></div><p>Arrows with curved shafts don't always render the way our intuition
may lead us to expect. One could reasonably expect that the arc in the
above example would produce an arrow curving upwards, not the
downwards-curving one we see.  To understand what's going on, imagine
that the arc is <code class="sourceCode"><span class="dt">Located</span></code>. Suppose the arc goes from the point
\((0,0)\) to \((-1,0)\). This is indeed an upwards curving arc
with origin at \((0,0)\). Now suppose we want to connect points
\((0,0)\) and \((1,0)\). We attach the arrow head and tail and
rotate the arrow about its origin at \((0,0)\) until the tip of
the head is touching \((1,0)\).  This rotation flips the arrow
vertically.  To make an arc that runs clockwise from its starting
point, use a negative <code class="sourceCode"><span class="dt">Angle</span></code>.</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> shaft <span class="fu">=</span> arc xDir (<span class="fu">-</span><span class="dv">1</span><span class="fu">/</span><span class="dv">2</span> <span class="fu">@@</span> turn)</code></pre></div></div><div class="exampleimg"><div style="text-align: center"><img src="images/f2a4641596591c64.png" width="500" height="200" /></div></div><div class="warning bs-callout bs-callout-warning"><p>If an arrow shaft does not appear as you expect, then try using
<code class="sourceCode">reverseTrail</code>, or in the case of arcs, multiplying the angle by -1.</p></div><p>Here are some exercises to try.</p><div class="exercises panel panel-success"><div class="panel-body"><p>Construct each of the following arrows pointing from \((1,1)\) to
\((3,3)\) inside a square with side \(4\).</p><ol><li><p>A straight arrow with no head and a spike shaped tail.</p></li><li><p>An arrow with a \(45\) degree arc for a shaft, triangles for both head
and tail, curving downwards.</p></li><li><p>The same as above, only now make it curve upwards.</p></li></ol></div></div></div><div class="section" id="lengths-and-gaps"><h2>Lengths and Gaps</h2><p>The fields <code class="sourceCode">headLength</code> and <code class="sourceCode">tailLength</code> are for setting the length of
the head and tail. The head length is measured from the tip of the
head to the start of the joint connecting the head to the shaft. The
tail length is measured in an analagous manner. They have type
<code class="sourceCode"><span class="dt">Measure</span> <span class="dt">Double</span></code> and the default is <code class="sourceCode">normal</code>. <code class="sourceCode">headGap</code> and <code class="sourceCode">tailGap</code>
options are fairly self explanatory: they leave space at the end or
beginning of the arrow and are also of type <code class="sourceCode"><span class="dt">Mesure</span> <span class="dt">Double</span></code>; the
default is <code class="sourceCode">none</code>.  Take a look at their effect in the following
example:</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/5c0174844ae8e1eb.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> sPt <span class="fu">=</span> p2 (<span class="fl">0.20</span>, <span class="fl">0.50</span>)
<span class="ot">></span> mPt <span class="fu">=</span> p2 (<span class="fl">1.50</span>, <span class="fl">0.50</span>)
<span class="ot">></span> ePt <span class="fu">=</span> p2 (<span class="fl">2.80</span>, <span class="fl">0.50</span>)
<span class="ot">></span>
<span class="ot">></span> spot  <span class="fu">=</span> circle <span class="fl">0.02</span> <span class="fu">#</span> lw none
<span class="ot">></span> sDot <span class="fu">=</span> spot <span class="fu">#</span> fc blue  <span class="fu">#</span> moveTo sPt
<span class="ot">></span> mDot <span class="fu">=</span> spot <span class="fu">#</span> fc green <span class="fu">#</span> moveTo mPt
<span class="ot">></span> eDot <span class="fu">=</span> spot <span class="fu">#</span> fc red   <span class="fu">#</span> moveTo ePt
<span class="ot">></span>
<span class="ot">></span>
<span class="ot">></span> leftArrow  <span class="fu">=</span> arrowBetween' (with <span class="fu">&</span> arrowHead  <span class="fu">.~</span> dart  <span class="fu">&</span> arrowTail <span class="fu">.~</span> tri'
<span class="ot">></span>                                  <span class="fu">&</span> headLength <span class="fu">.~</span> large <span class="fu">&</span> tailLength <span class="fu">.~</span> normal
<span class="ot">></span>                                  <span class="fu">&</span> headGap    <span class="fu">.~</span> large) sPt mPt
<span class="ot">></span>
<span class="ot">></span> rightArrow <span class="fu">=</span> arrowBetween' (with <span class="fu">&</span> arrowHead  <span class="fu">.~</span> spike <span class="fu">&</span> arrowTail <span class="fu">.~</span> dart'
<span class="ot">></span>                                  <span class="fu">&</span> shaftStyle <span class="fu">%~</span> lw ultraThick
<span class="ot">></span>                                  <span class="fu">&</span> tailLength <span class="fu">.~</span> veryLarge <span class="fu">&</span> headLength <span class="fu">.~</span> huge
<span class="ot">></span>                                  <span class="fu">&</span> tailGap    <span class="fu">.~</span> veryLarge) mPt ePt
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span> ( sDot <span class="fu"><></span> mDot <span class="fu"><></span> eDot <span class="fu"><></span> leftArrow <span class="fu"><></span> rightArrow)
<span class="ot">></span>           <span class="fu">#</span> frame <span class="fl">0.25</span></code></pre></div></div></div><p>Our use of the <span class="package"><a href="http://hackage.haskell.org/package/lens"><code>lens</code></a></span> package allows us to create other lenses to
modify <code class="sourceCode"><span class="dt">ArrowOpts</span></code> using the same syntax as the record field
lenses. <code class="sourceCode">lengths</code> is useful for setting the <code class="sourceCode">headLength</code> and <code class="sourceCode">tailLength</code>
simultaneously and <code class="sourceCode">gaps</code> can be used to simultaneously set
the <code class="sourceCode">headGap</code> / <code class="sourceCode">tailGap</code>.</p><p>A useful pattern is to use <code class="sourceCode">lineTail</code> together with <code class="sourceCode">lengths</code> as in the
following example:</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/69d44e6a57c43ad7.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> dia <span class="fu">=</span> (rect <span class="dv">5</span> <span class="dv">2</span> <span class="fu">#</span> fc lavender <span class="fu">#</span> alignX (<span class="fu">-</span><span class="dv">1</span>) <span class="fu">#</span> showOrigin <span class="fu">#</span> named <span class="st">"A"</span>)
<span class="ot">></span>        <span class="fu">===</span> strutY <span class="dv">2</span> <span class="fu">===</span>
<span class="ot">></span>       (rect <span class="dv">5</span> <span class="dv">2</span> <span class="fu">#</span> fc pink <span class="fu">#</span> alignX (<span class="fu">-</span><span class="dv">1</span>) <span class="fu">#</span> showOrigin <span class="fu">#</span> named <span class="st">"B"</span>)
<span class="ot">></span>
<span class="ot">></span> ushaft <span class="fu">=</span> trailFromVertices (map p2 [(<span class="dv">0</span>, <span class="dv">0</span>), (<span class="fu">-</span><span class="fl">0.5</span>, <span class="dv">0</span>), (<span class="fu">-</span><span class="fl">0.5</span>, <span class="dv">1</span>), (<span class="dv">0</span>, <span class="dv">1</span>)])
<span class="ot">></span>
<span class="ot">></span> uconnect tl setWd <span class="fu">=</span>
<span class="ot">></span>   connect' (with
<span class="ot">></span>           <span class="fu">&</span> arrowHead  <span class="fu">.~</span> spike
<span class="ot">></span>           <span class="fu">&</span> arrowShaft <span class="fu">.~</span> ushaft
<span class="ot">></span>           <span class="fu">&</span> arrowTail  <span class="fu">.~</span> tl
<span class="ot">></span>           <span class="fu">&</span> setWd)
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span>
<span class="ot">></span>   hcat' (with <span class="fu">&</span> sep <span class="fu">.~</span> <span class="fl">1.5</span>)
<span class="ot">></span>   [ dia <span class="fu">#</span> uconnect noTail   (headLength <span class="fu">.~</span> veryLarge) <span class="st">"B"</span> <span class="st">"A"</span>  <span class="co">-- looks bad</span>
<span class="ot">></span>   , dia <span class="fu">#</span> uconnect lineTail (lengths    <span class="fu">.~</span> veryLarge) <span class="st">"B"</span> <span class="st">"A"</span>  <span class="co">-- looks good!</span>
<span class="ot">></span>   ]
<span class="ot">></span>   <span class="fu">#</span> frame <span class="fl">0.25</span></code></pre></div></div></div></div><div class="section" id="the-style-options"><h2>The style options</h2><p>By default, arrows are drawn using the current line color (including
the head and tail).  In addition, the shaft styling is taken from the
current line styling attributes.  For example:</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/8945465139a39725.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> example <span class="fu">=</span> mconcat
<span class="ot">></span>   [ square <span class="dv">2</span>
<span class="ot">></span>   , arrowAt' (with <span class="fu">&</span> headLength <span class="fu">.~</span> veryLarge) origin unitX
<span class="ot">></span>     <span class="fu">#</span> lc blue <span class="fu">#</span> lw thick
<span class="ot">></span>   ]
<span class="ot">></span>   <span class="fu">#</span> dashingG [<span class="fl">0.05</span>, <span class="fl">0.05</span>] <span class="dv">0</span></code></pre></div></div></div><p>The colors (or more generally textues) of the head, tail, and shaft
may be individually overridden using <code class="sourceCode">headTexture</code>, <code class="sourceCode">tailTexture</code>, and
<code class="sourceCode">shaftTexture</code> in conjunction with the <code class="sourceCode">solid</code> function.  More generally, the
styles are controlled using <code class="sourceCode">headStyle</code>, <code class="sourceCode">tailStyle</code>, and <code class="sourceCode">shaftStyle</code>. For
example:</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> dashedArrow <span class="fu">=</span> arrowBetween' (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> dart <span class="fu">&</span> arrowTail <span class="fu">.~</span> spike' <span class="fu">&</span> lengths <span class="fu">.~</span> veryLarge
<span class="ot">></span>                                   <span class="fu">&</span> headTexture <span class="fu">.~</span> solid blue <span class="fu">&</span> tailTexture <span class="fu">.~</span> solid orange
<span class="ot">></span>                                   <span class="fu">&</span> shaftStyle <span class="fu">%~</span> dashingG [<span class="fl">0.04</span>, <span class="fl">0.02</span>] <span class="dv">0</span>
<span class="ot">></span>                                   <span class="fu">.</span> lw thick) sPt ePt
<span class="ot">></span></code></pre></div></div><div class="exampleimg"><div style="text-align: center"><img src="images/6aa6143c0878f345.png" width="500" height="200" /></div></div><p>Note that when setting a style, one must generally use the <code class="sourceCode"><span class="fu">%~</span></code>
operator in order to apply something like <code class="sourceCode">dashingG [<span class="fl">0.04</span>, <span class="fl">0.02</span>] <span class="dv">0</span></code>
which is a <em>function</em> that changes the style.</p><div class="warning bs-callout bs-callout-warning"><p>By default, the ambient line color is used for the head, tail, and
shaft of an arrow.  However, when setting the styles individually,
the fill color should be used for the head and tail, and line color
for the shaft.</p></div></div></div><div class="section" id="placing-an-arrow-at-a-point"><h1>Placing an arrow at a point</h1><p>Sometimes we prefer to specify a starting point and vector from which the arrow
takes its magnitude and direction. The <code class="sourceCode">arrowAt'</code> and
<code class="sourceCode">arrowAt</code> functions are useful in this regard. The example below demonstrates
how we might create a vector field using the <code class="sourceCode">arrowAt'</code> function.</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/7bc215b1f1ed6121.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> locs   <span class="fu">=</span> [(x, y) <span class="fu">|</span> x <span class="ot"><-</span> [<span class="fl">0.1</span>, <span class="fl">0.3</span> <span class="fu">..</span> <span class="fl">3.25</span>], y <span class="ot"><-</span> [<span class="fl">0.1</span>, <span class="fl">0.3</span> <span class="fu">..</span> <span class="fl">3.25</span>]]
<span class="ot">></span>
<span class="ot">></span> <span class="co">-- create a list of points where the vectors will be place.</span>
<span class="ot">></span> points <span class="fu">=</span> map p2 locs
<span class="ot">></span>
<span class="ot">></span> <span class="co">-- The function to use to create the vector field.</span>
<span class="ot">></span> vectorField (x, y) <span class="fu">=</span> r2 (sin (y <span class="fu">+</span> <span class="dv">1</span>), sin (x <span class="fu">+</span> <span class="dv">1</span>))
<span class="ot">></span>
<span class="ot">></span> arrows <span class="fu">=</span> map arrowAtPoint locs
<span class="ot">></span>
<span class="ot">></span> arrowAtPoint (x, y) <span class="fu">=</span> arrowAt' opts (p2 (x, y)) (sL <span class="fu">*^</span> vf) <span class="fu">#</span> alignTL
<span class="ot">></span>   <span class="kw">where</span>
<span class="ot">></span>     vf   <span class="fu">=</span> vectorField (x, y)
<span class="ot">></span>     m    <span class="fu">=</span> norm <span class="fu">$</span> vectorField (x, y)
<span class="ot">></span>
<span class="ot">></span>     <span class="co">-- Head size is a function of the length of the vector</span>
<span class="ot">></span>     <span class="co">-- as are tail size and shaft length.</span>
<span class="ot">></span>     hs   <span class="fu">=</span> <span class="fl">0.08</span> <span class="fu">*</span> m
<span class="ot">></span>     sW   <span class="fu">=</span> <span class="fl">0.015</span> <span class="fu">*</span> m
<span class="ot">></span>     sL   <span class="fu">=</span> <span class="fl">0.01</span> <span class="fu">+</span> <span class="fl">0.1</span> <span class="fu">*</span> m
<span class="ot">></span>     opts <span class="fu">=</span> (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> tri <span class="fu">&</span> headLength <span class="fu">.~</span> global hs <span class="fu">&</span> shaftStyle <span class="fu">%~</span> lwG sW)
<span class="ot">></span>
<span class="ot">></span> field   <span class="fu">=</span> position <span class="fu">$</span> zip points arrows
<span class="ot">></span> example <span class="fu">=</span> ( field <span class="fu">#</span> translateY <span class="fl">0.05</span>
<span class="ot">></span>        <span class="fu"><></span> ( square <span class="fl">3.5</span> <span class="fu">#</span> fc whitesmoke <span class="fu">#</span> lwG <span class="fl">0.02</span> <span class="fu">#</span> alignBL))
<span class="ot">></span>         <span class="fu">#</span> scaleX <span class="dv">2</span></code></pre></div></div></div><p>Your turn:</p><div class="exercises panel panel-success"><div class="panel-body"><p>Try using the above code to plot some other interesting vector fields.</p></div></div></div><div class="section" id="connecting-diagrams-with-arrows"><h1>Connecting diagrams with arrows</h1><p>The workhorse of the Arrow package is the <code class="sourceCode">connect'</code>
function. <code class="sourceCode">connect'</code> takes an options record and the names of two
diagrams, and places an arrow starting at the origin of the first
diagram and ending at the origin of the second (unless gaps are
specified).</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/ce9281e367e56602.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> s  <span class="fu">=</span> square <span class="dv">2</span> <span class="fu">#</span> showOrigin <span class="fu">#</span> lw thick
<span class="ot">></span> ds <span class="fu">=</span> (s <span class="fu">#</span> named <span class="st">"1"</span>) <span class="fu">|||</span> strutX <span class="dv">3</span> <span class="fu">|||</span> (s <span class="fu">#</span> named <span class="st">"2"</span>)
<span class="ot">></span> t  <span class="fu">=</span> cubicSpline <span class="dt">False</span> (map p2 [(<span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">1</span>, <span class="dv">0</span>), (<span class="dv">1</span>, <span class="fl">0.2</span>), (<span class="dv">2</span>, <span class="fl">0.2</span>)])
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span> ds <span class="fu">#</span> connect' (with <span class="fu">&</span> arrowHead <span class="fu">.~</span> dart <span class="fu">&</span> lengths <span class="fu">.~</span> veryLarge
<span class="ot">></span>                               <span class="fu">&</span> arrowTail <span class="fu">.~</span> dart'
<span class="ot">></span>                               <span class="fu">&</span> shaftStyle <span class="fu">%~</span> lw thick <span class="fu">&</span> arrowShaft <span class="fu">.~</span> t) <span class="st">"1"</span> <span class="st">"2"</span></code></pre></div></div></div></div><div class="section" id="connecting-points-on-the-trace-of-diagrams"><h1>Connecting points on the trace of diagrams</h1><p>It is often convenient to be able to connect the points on the <code class="sourceCode"><span class="dt">Trace</span></code>
of diagrams with arrows. The <code class="sourceCode">connectPerim'</code> and <code class="sourceCode">connectOutside'</code>
functions are used for this purpose. We pass <code class="sourceCode">connectPerim</code> two names
and two angles. The angles are used to determine points on the traces
of the two diagrams, determined by shooting a ray from the local
origin of each diagram in the direction of the given angle.  The
generated arrow stretches between these two points. Note that if the
names are the same then the arrow connects two points on the same
diagram.</p><p>In the case of <code class="sourceCode">connectOutside</code>, the arrow lies on the line between
the centers of the diagrams, but is drawn so that it stops at the
boundaries of the diagrams, using traces to find the intersection
points.</p><div class="examplesrc"><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> connectOutside <span class="st">"diagram1"</span> <span class="st">"diagram2"</span>
<span class="ot">></span> connectPerim <span class="st">"diagram"</span> <span class="st">"diagram"</span> (<span class="dv">2</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn) (<span class="dv">4</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn)</code></pre></div></div><p>Here is an example of a finite state automata that accepts real numbers.
The code is a bit longer than what we have seen so far, but still very
straightforward.</p><div class="dia-lhs panel panel-default"><div class="panel-body"><div style="text-align: center"><img src="images/3102d48f4635f1d1.png" width="500" height="200" /></div><div class="sourceCode"><pre class="sourceCode"><code class="sourceCode"><span class="ot">></span> text' font d s <span class="fu">=</span> (strokeP <span class="fu">$</span> textSVG' (<span class="dt">TextOpts</span> font <span class="dt">INSIDE_H</span> <span class="dt">KERN</span> <span class="dt">False</span> d d) s)
<span class="ot">></span>                <span class="fu">#</span> lw none <span class="fu">#</span> fc black
<span class="ot">></span>
<span class="ot">></span> stateLabel font <span class="fu">=</span> text' font <span class="dv">6</span>
<span class="ot">></span> arrowLabel font txt size <span class="fu">=</span> text' font size txt
<span class="ot">></span>
<span class="ot">></span> state  <span class="fu">=</span> circle <span class="dv">4</span> <span class="fu">#</span> fc silver
<span class="ot">></span> fState <span class="fu">=</span> circle <span class="fl">3.7</span> <span class="fu">#</span> fc lightblue <span class="fu"><></span> state
<span class="ot">></span>
<span class="ot">></span> points <span class="fu">=</span> map p2 [ (<span class="dv">0</span>, <span class="dv">12</span>), (<span class="dv">12</span>, <span class="dv">16</span>), (<span class="dv">24</span>, <span class="dv">12</span>), (<span class="dv">24</span>, <span class="dv">21</span>), (<span class="dv">36</span>, <span class="dv">16</span>), (<span class="dv">48</span>, <span class="dv">12</span>)
<span class="ot">></span>                 , (<span class="dv">48</span>, <span class="dv">21</span>), (<span class="dv">12</span>, <span class="dv">0</span>), (<span class="dv">7</span>, <span class="dv">7</span>), (<span class="dv">24</span>, <span class="dv">4</span>), (<span class="dv">36</span>, <span class="dv">0</span>), (<span class="dv">46</span>, <span class="dv">0</span>)]
<span class="ot">></span>
<span class="ot">></span> ds f <span class="fu">=</span> [ (stateLabel f <span class="st">"1"</span> <span class="fu"><></span> state)  <span class="fu">#</span> named <span class="st">"1"</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"0-9"</span> <span class="dv">4</span>
<span class="ot">></span>        , (stateLabel f <span class="st">"2"</span> <span class="fu"><></span> state)  <span class="fu">#</span> named <span class="st">"2"</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"0-9"</span> <span class="dv">4</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"."</span> <span class="dv">8</span>
<span class="ot">></span>        , (stateLabel f <span class="st">"3"</span> <span class="fu"><></span> fState) <span class="fu">#</span> named <span class="st">"3"</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"0-9"</span> <span class="dv">4</span>
<span class="ot">></span>        , (stateLabel f <span class="st">"4"</span> <span class="fu"><></span> state)  <span class="fu">#</span> named <span class="st">"4"</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"."</span> <span class="dv">8</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"0-9"</span> <span class="dv">4</span>
<span class="ot">></span>        , (stateLabel f <span class="st">"5"</span> <span class="fu"><></span> fState) <span class="fu">#</span> named <span class="st">"5"</span>
<span class="ot">></span>        ,  arrowLabel f <span class="st">"0-9"</span> <span class="dv">4</span>]
<span class="ot">></span>
<span class="ot">></span> states f <span class="fu">=</span> position (zip points (ds f))
<span class="ot">></span>
<span class="ot">></span> shaft  <span class="fu">=</span> arc xDir (<span class="fu">-</span><span class="dv">1</span><span class="fu">/</span><span class="dv">6</span> <span class="fu">@@</span> turn)
<span class="ot">></span> shaft' <span class="fu">=</span> arc xDir (<span class="fu">-</span><span class="fl">2.7</span><span class="fu">/</span><span class="dv">5</span> <span class="fu">@@</span> turn)
<span class="ot">></span> line <span class="fu">=</span> trailFromOffsets [unitX]
<span class="ot">></span>
<span class="ot">></span> arrowStyle1 <span class="fu">=</span> (with  <span class="fu">&</span> arrowHead  <span class="fu">.~</span> spike <span class="fu">&</span> headLength <span class="fu">.~</span> normal
<span class="ot">></span>                      <span class="fu">&</span> arrowShaft <span class="fu">.~</span> shaft)
<span class="ot">></span>
<span class="ot">></span> arrowStyle2 <span class="fu">=</span> (with  <span class="fu">&</span> arrowHead   <span class="fu">.~</span> spike
<span class="ot">></span>                      <span class="fu">&</span> arrowShaft  <span class="fu">.~</span> shaft' <span class="fu">&</span> arrowTail <span class="fu">.~</span> lineTail
<span class="ot">></span>                      <span class="fu">&</span> tailTexture <span class="fu">.~</span> solid black <span class="fu">&</span> lengths <span class="fu">.~</span> normal)
<span class="ot">></span>
<span class="ot">></span> arrowStyle3 <span class="fu">=</span> (with  <span class="fu">&</span> arrowHead  <span class="fu">.~</span> spike  <span class="fu">&</span> headLength <span class="fu">.~</span> normal
<span class="ot">></span>                      <span class="fu">&</span> arrowShaft <span class="fu">.~</span> line)
<span class="ot">></span>
<span class="ot">></span> example <span class="fu">=</span> <span class="kw">do</span>
<span class="ot">></span>   font <span class="ot"><-</span> lin2
<span class="ot">></span>   return <span class="fu">$</span> states font
<span class="ot">></span>     <span class="fu">#</span> connectOutside' arrowStyle1 <span class="st">"1"</span> <span class="st">"2"</span>
<span class="ot">></span>     <span class="fu">#</span> connectOutside' arrowStyle3 <span class="st">"1"</span> <span class="st">"4"</span>
<span class="ot">></span>     <span class="fu">#</span> connectPerim'   arrowStyle2 <span class="st">"2"</span> <span class="st">"2"</span> (<span class="dv">4</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn) (<span class="dv">2</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn)
<span class="ot">></span>     <span class="fu">#</span> connectOutside' arrowStyle1 <span class="st">"2"</span> <span class="st">"3"</span>
<span class="ot">></span>     <span class="fu">#</span> connectPerim'   arrowStyle2 <span class="st">"3"</span> <span class="st">"3"</span> (<span class="dv">4</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn) (<span class="dv">2</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn)
<span class="ot">></span>     <span class="fu">#</span> connectOutside' arrowStyle1 <span class="st">"4"</span> <span class="st">"5"</span>
<span class="ot">></span>     <span class="fu">#</span> connectPerim'   arrowStyle2 <span class="st">"5"</span> <span class="st">"5"</span> (<span class="dv">1</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn) (<span class="fu">-</span><span class="dv">1</span><span class="fu">/</span><span class="dv">12</span> <span class="fu">@@</span> turn)</code></pre></div></div></div><p>In the following exercise you can try <code class="sourceCode">connectPerim'</code> for yourself.</p><div class="exercises panel panel-success"><div class="panel-body"><p>Create a torus (donut) with \(16\) curved arrows pointing from the
outer ring to the inner ring at the same angle every <code class="sourceCode"><span class="dv">1</span><span class="fu">/</span><span class="dv">16</span> <span class="fu">@@</span> turn</code>.</p><blockquote><div class="exampleimg"><div style="text-align: center"><img src="images/168cbe071e4a7e6a.png" width="500" height="200" /></div></div></blockquote></div></div></div></div></div></div>

    </div>

    </div> <!-- #wrap -->

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/bootstrap-docs-application.js"></script>
    <script src="../js/hoogle-search.js"></script>
  </body>
</html>
