<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Diagrams - Square Limit</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <!-- Bootstrap -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/sticky-footer-navbar.css" rel="stylesheet" />
    <link href="../css/callout.css" rel="stylesheet" />
    <link href="../css/doc.css" rel="stylesheet" />
    <link href="../css/bootstrap-docs.css" rel="stylesheet" />
    <link href="../css/home.css" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    <link rel="shortcut icon" href="../diagrams.ico" />

    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>

    <div id="wrap">

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../">diagrams</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav pull-right">
            <li><a href="../">Home</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
              <ul class="dropdown-menu">
		<li><a href="../download.html">Installation</a></li>
		<li class="divider"></li>
 		<li><a href="../tutorials.html">Tutorials</a></li>
		<li><a href="../doc/manual.html">User manual</a></li>
                <li><a href="../haddock/index.html">API reference (Haddocks)</a></li>
                <li><a href="../doc/core.html">Core library reference</a></li>
		<li class="divider"></li>
		<li><a href="http://haskell.org/haskellwiki/Diagrams">Wiki</a></li>
		<li><a href="../releases.html">Releases / changelogs</a></li>
              </ul>
            </li>
	    <li><a href="../gallery.html">Gallery</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
	      <ul class="dropdown-menu">
		<li><a href="http://webchat.freenode.net?channels=diagrams">IRC channel</a></li>
		<li><a href="http://groups.google.com/group/diagrams-discuss">Mailing
		    list</a></li>
                <li><a href="https://github.com/diagrams">Github</a></li>
		<li><a href="../sightings.html">Sightings</a></li>
		<li><a href="../community.html">Get involved</a></li>
              </ul>
	    </li>
            <li><a href="../blog/index.html">Blog</a></li>
	    <li>
	        <form id="search" class="navbar-form navbar-left" role="search" method="get" action="http://haskell.org/hoogle">
	            <div class="form-group">
	                <input id="hoogle" name="hoogle" type="text" class="form-control" placeholder="API Search">
	            </div>
	        </form>
	    </li>
	   </ul>
        </div>
      </div>
    </div>
    
    <div class="container" style="padding-top: 60px;">
      <div id="examplesrc">

<p>A reconstruction of M C Escher’s print “Square Limit”.</p>

<div class="exampleimg" style="text-align: center">
<img src="../gallery/images/SquareLimit.big.png" width="400" height="400" />
</div>
Author: <b><a href="https://www.cs.ox.ac.uk/people/jeremy.gibbons/">Jeremy Gibbons</a></b>

<p><span style="font-size: small"><a href="../gallery/SquareLimit.lhs">Download raw source code</a></span><br /></p>

<div class="sourceCode" id="cb1"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Diagrams.Backend.SVG.CmdLine</span></span></code></pre></div>
<p>This is a reconstruction of <a href="http://www.wikipaintings.org/en/m-c-escher/square-limit">M C Escher’s print “Square
Limit”</a>. It
is based on the classic paper “Functional Geometry” by Peter Henderson
(in Lisp and Functional Programming, 1982). But we take a slightly
different approach: using lazy evaluation, we construct an infinite
diagram, then prune it to some finite depth before writing out as
SVG—Henderson’s code hardwired an unrolling to a particular depth.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE NoMonomorphismRestriction #-}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Prelude</span> <span class="kw">hiding</span> (cycle)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Diagrams.Prelude</span></span></code></pre></div>
<p>The type signatures are more specific than necessary, but perhaps
easier to understand this way.</p>
<p>The diagram is constructed from five basic tiles: four with specific
markings on, and a fifth which is blank, all \(16 \times 16\). The actual
markings are defined at the end of the file.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ot">blank ::</span> <span class="dt">Diagram</span> <span class="dt">B</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>blank <span class="ot">=</span> lw none <span class="op">$</span> square <span class="dv">16</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ot">makeTile ::</span> [[<span class="dt">P2</span> <span class="dt">Double</span>]] <span class="ot">-&gt;</span> <span class="dt">Diagram</span> <span class="dt">B</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>makeTile <span class="ot">=</span> showOrigin <span class="op">.</span> lw thin <span class="op">.</span> centerXY <span class="op">.</span> <span class="fu">mconcat</span> <span class="op">.</span> <span class="fu">map</span> fromVertices <span class="kw">where</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>markingsP, markingsQ, markingsR,<span class="ot"> markingsS ::</span> [[<span class="dt">P2</span> <span class="dt">Double</span>]]</span></code></pre></div>
<p>Here is an algenraic datatype of pictures. Composition is by
juxtaposition, which requires bounding boxes. In order to achieve this
even with infinite pictures, we make all pictures the same size
(\(16 \times 16\)), by scaling.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Picture</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> <span class="dt">Blank</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Single</span> [[<span class="dt">P2</span> <span class="dt">Double</span>]]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Rot</span> <span class="dt">Picture</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Cycle</span> <span class="dt">Picture</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">HPair</span> <span class="dt">Picture</span> <span class="dt">Picture</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">VPair</span> <span class="dt">Picture</span> <span class="dt">Picture</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Quartet</span> <span class="dt">Picture</span> <span class="dt">Picture</span> <span class="dt">Picture</span> <span class="dt">Picture</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">SkewQuartet</span> <span class="dt">Picture</span> <span class="dt">Picture</span> <span class="dt">Picture</span> <span class="dt">Picture</span> <span class="co">-- left column and bottom row half size</span></span></code></pre></div>
<p><code>Blank</code> and <code>Single</code> correspond to the basic tiles. <code>Rot</code> rotates by \(90\)
degrees, anticlockwise. <code>Cycle</code> puts together four half-size copies of a
picture: unrotated at top right, and each one anticlockwise from there
rotated by a further quarter turn. <code>HPair</code> puts two pictures side by
side, and <code>VPair</code> one above another; each picture is scaled by a half in
one dimension. <code>Quartet</code> puts together four pictures at half
size. <code>SkewQuartet</code> does similarly, but in a \(2:1\) size ratio: the left
column is half the width and the bottom row half the right of the
right column and the top row. These maintain the invariant at all
pictures are the same size.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rot p <span class="ot">=</span> rotateBy (<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) p</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cycle</span> p <span class="ot">=</span> quartet (rot p) p (rot <span class="op">$</span> rot p) (rot <span class="op">$</span> rot <span class="op">$</span> rot p)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>hpair p q <span class="ot">=</span> scaleX (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">$</span> centerXY (p <span class="op">|||</span> q)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>vpair p q <span class="ot">=</span> scaleY (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">$</span> centerXY (p <span class="op">===</span> q)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>quartet p q r s <span class="ot">=</span> scale (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">$</span> centerXY ((p <span class="op">|||</span> q) <span class="op">===</span> (r <span class="op">|||</span> s))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>skewquartet p q r s <span class="ot">=</span> scale (<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">$</span> centerXY ((scaleY <span class="dv">2</span> p <span class="op">|||</span> scale <span class="dv">2</span> q)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                              <span class="op">===</span> (r <span class="op">|||</span> scaleX <span class="dv">2</span> s))</span></code></pre></div>
<p>Folding with these operators draws a whole picture.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ot">drawPicture ::</span> <span class="dt">Picture</span> <span class="ot">-&gt;</span> <span class="dt">Diagram</span> <span class="dt">B</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>drawPicture <span class="dt">Blank</span> <span class="ot">=</span> blank</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">Single</span> m) <span class="ot">=</span> makeTile m</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">Rot</span> p) <span class="ot">=</span> rot (drawPicture p)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">Cycle</span> p) <span class="ot">=</span> <span class="fu">cycle</span> (drawPicture p)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">HPair</span> p q) <span class="ot">=</span> hpair (drawPicture p) (drawPicture q)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">VPair</span> p q) <span class="ot">=</span> vpair (drawPicture p) (drawPicture q)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">Quartet</span> p q r s)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> quartet (drawPicture p) (drawPicture q) (drawPicture r) (drawPicture s)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>drawPicture (<span class="dt">SkewQuartet</span> p q r s)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> skewquartet (drawPicture p) (drawPicture q) (drawPicture r) (drawPicture s)</span></code></pre></div>
<p>Pruning with <code>prune s p</code> cuts off a picture <code>p</code> when its scale gets
below \(1/s\). We keep track of the scale in \(x\) and \(y\) separately, to cope
with the non-homogeneous scaling in <code>HPair</code> and <code>VPair</code>. The definition
only works properly if <code>Cycles</code> are scaled only homogeneously; that is
the case in Escher’s picture.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ot">prune ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">Picture</span> <span class="ot">-&gt;</span> <span class="dt">Picture</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>prune s p <span class="ot">=</span> prune' (s,s) p <span class="kw">where</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) p <span class="op">|</span> <span class="fu">min</span> x y <span class="op">&lt;</span> <span class="dv">1</span> <span class="ot">=</span> <span class="dt">Blank</span> <span class="co">-- cut off when either factor &lt;1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) <span class="dt">Blank</span> <span class="ot">=</span> <span class="dt">Blank</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">Single</span> m) <span class="ot">=</span> <span class="dt">Single</span> m</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">Rot</span> p) <span class="ot">=</span> <span class="dt">Rot</span> (prune' (y,x) p)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">Cycle</span> p) <span class="ot">=</span> <span class="dt">Cycle</span> (prune' (x<span class="op">/</span><span class="dv">2</span>,y<span class="op">/</span><span class="dv">2</span>) p) <span class="co">-- assumes x==y</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">HPair</span> p q) <span class="ot">=</span> <span class="dt">HPair</span> (prune' (x<span class="op">/</span><span class="dv">2</span>,y) p) (prune' (x<span class="op">/</span><span class="dv">2</span>,y) q)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">VPair</span> p q) <span class="ot">=</span> <span class="dt">VPair</span> (prune' (x,y<span class="op">/</span><span class="dv">2</span>) p) (prune' (x,y<span class="op">/</span><span class="dv">2</span>) q)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">Quartet</span> p q r s)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="dt">Quartet</span> (prune' x2y2 p) (prune' x2y2 q) (prune' x2y2 r) (prune' x2y2 s)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> x2y2 <span class="ot">=</span> (x<span class="op">/</span><span class="dv">2</span>,y<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  prune' (x,y) (<span class="dt">SkewQuartet</span> p q r s)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="dt">SkewQuartet</span> (prune' (x3,y32) p) (prune' (x32,y32) q)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                  (prune' (x3,y3) r) (prune' (x32,y3) s)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> (x3,y3,x32,y32) <span class="ot">=</span> (x<span class="op">/</span><span class="dv">3</span>,y<span class="op">/</span><span class="dv">3</span>,x3<span class="op">*</span><span class="dv">2</span>,y3<span class="op">*</span><span class="dv">2</span>)</span></code></pre></div>
<p>Now for the construction of Escher’s Square Limit. The four basic
tiles are as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fishP <span class="ot">=</span> <span class="dt">Single</span> markingsP</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fishQ <span class="ot">=</span> <span class="dt">Single</span> markingsQ</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fishR <span class="ot">=</span> <span class="dt">Single</span> markingsR</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fishS <span class="ot">=</span> <span class="dt">Single</span> markingsS</span></code></pre></div>
<p>Henderson puts them together in a quartet, and cycles this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fishT <span class="ot">=</span> <span class="dt">Quartet</span> fishP fishQ fishR fishS</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fishU <span class="ot">=</span> <span class="dt">Cycle</span> (<span class="dt">Rot</span> fishQ)</span></code></pre></div>
<p>This is the recursive structure of one corner of Square Limit:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>corner <span class="ot">=</span> <span class="dt">SkewQuartet</span> p q r s <span class="kw">where</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="dt">VPair</span> p' fishT</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  p' <span class="ot">=</span> <span class="dt">HPair</span> (<span class="dt">Rot</span> s) p</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">=</span> <span class="dt">Quartet</span> p' q fishU s'</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">=</span> fishQ</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="dt">HPair</span> fishT s'</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  s' <span class="ot">=</span> <span class="dt">VPair</span> s (<span class="dt">Rot</span> (<span class="dt">Rot</span> (<span class="dt">Rot</span> p)))</span></code></pre></div>
<p>The final picture is a cycle of these corners.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>squarelimit <span class="ot">=</span> <span class="dt">Cycle</span> corner</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>example <span class="ot">=</span> drawPicture (prune <span class="dv">24</span> squarelimit) <span class="ot">`atop`</span> square <span class="fl">14.5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">#</span> fc darkseagreen</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">#</span> opacity <span class="fl">0.5</span></span></code></pre></div>
<p>The markings on the four basic tiles are taken from <a href="http://www.frank-buss.de/lisp/functional.html">a note by Frank
Buss</a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>markingsP <span class="ot">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">3</span>), (<span class="dv">3</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">3</span>) ],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">5</span>) ],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">16</span>) ],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">2</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">2</span>) ],</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">4</span>) ],</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">9</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">7</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">6</span>) ],</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">9</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">10</span>) ],</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">12</span>) ],</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">14</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">13</span>) ],</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">14</span>) ],</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">15</span>) ]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  ]</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>markingsQ <span class="ot">=</span> [</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">7</span>) ],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">7</span>) ],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">9</span>) ],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">11</span>) ],</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">7</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">7</span>), (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">6</span>) ],</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">4</span>) ],</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">2</span>) ],</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">11</span>) ],</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">9</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">9</span><span class="op">^&amp;</span><span class="dv">12</span>) ],</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">9</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">15</span>) ],</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">3</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">16</span>) ],</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">3</span><span class="op">^&amp;</span><span class="dv">13</span>) ],</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">5</span><span class="op">^&amp;</span><span class="dv">14</span>) ],</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">15</span>) ]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  ]</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>markingsR <span class="ot">=</span> [</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">1</span><span class="op">^&amp;</span><span class="dv">14</span>) ],</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">12</span>) ],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">5</span><span class="op">^&amp;</span><span class="dv">10</span>) ],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">1</span><span class="op">^&amp;</span><span class="dv">1</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">2</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">3</span><span class="op">^&amp;</span><span class="dv">3</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">2</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">5</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">3</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">4</span>) ],</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">6</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">6</span>) ],</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">16</span>) ],</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">10</span>) ],</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">14</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">12</span>) ],</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">15</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">14</span>) ]</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  ]</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>markingsS <span class="ot">=</span> [</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">0</span>), (<span class="dv">4</span><span class="op">^&amp;</span><span class="dv">2</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">2</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">2</span><span class="op">^&amp;</span><span class="dv">1</span>) ],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">4</span>) ],</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">6</span>) ],</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">10</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">12</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">10</span>) ],</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">0</span><span class="op">^&amp;</span><span class="dv">14</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">13</span>) ],</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">7</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">8</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">0</span>) ],</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">11</span><span class="op">^&amp;</span><span class="dv">10</span>) ],</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">6</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">4</span>), (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">7</span>), (<span class="dv">10</span><span class="op">^&amp;</span><span class="dv">6</span>) ],</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">7</span>), (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">5</span>), (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">8</span>), (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">7</span>) ],</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">12</span><span class="op">^&amp;</span><span class="dv">16</span>), (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">9</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">8</span>) ],</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">13</span><span class="op">^&amp;</span><span class="dv">13</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">14</span>) ],</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">14</span><span class="op">^&amp;</span><span class="dv">11</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">12</span>) ],</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  [ (<span class="dv">15</span><span class="op">^&amp;</span><span class="dv">9</span>), (<span class="dv">16</span><span class="op">^&amp;</span><span class="dv">10</span>) ]</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  ]</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> mainWith (<span class="ot">example ::</span> <span class="dt">Diagram</span> <span class="dt">B</span>)</span></code></pre></div>

</div>

    </div>

    </div> <!-- #wrap -->

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/bootstrap-docs-application.js"></script>
    <script src="../js/hoogle-search.js"></script>
  </body>
</html>
